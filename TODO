-- choose a good dfs order
remove unreachable nodes